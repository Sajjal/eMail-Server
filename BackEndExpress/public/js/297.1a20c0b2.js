"use strict";(self["webpackChunkemail_server"]=self["webpackChunkemail_server"]||[]).push([[297],{482:(e,a,t)=>{t.d(a,{Z:()=>u});t(71),t(7965),t(6016);var s=t(1959),n=t(52),o=t.n(n),l=t(9582),i=t(4584);const p=()=>{const e=(0,s.iH)(""),a=(0,s.iH)(null),t="/",n=(0,l.tv)(),p=async(e,s)=>{try{const n=await o().post(`${t}${e}`,s);i["default"].dispatch("updateEmails",{emails:n.data.data,count:n.data.count}),a.value=null,n.data||(a.value="No Data Available!")}catch(l){"401"!=l.response.status&&"429"!=l.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"})),a.value="No Data Available!"}},u=async e=>{try{const{data:a}=await o().post(`${t}download`,e,{responseType:"blob"}),s=document.createElement("a");return s.href=window.URL.createObjectURL(new Blob([a])),document.body.appendChild(s),s.download=e.name,s.click(),URL.revokeObjectURL(s.href)}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},d=async e=>{try{await o().post(`${t}toTrash`,e),n.push({name:"Login"})}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},r=async e=>{try{await o().post(`${t}addStar`,e),n.push({name:"Login"})}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},c=async e=>{try{await o().post(`${t}removeStar`,e),n.push({name:"Login"})}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},m=async e=>{try{await o().post(`${t}markAsRead`,e),n.push({name:"Login"})}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},f=async e=>{try{await o().post(`${t}block`,e)}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},g=async e=>{try{await o().post(`${t}unblock`,e)}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},v=async e=>{try{const s=await o().post(`${t}search`,e);a.value=null,i["default"].dispatch("updateCurrentMessage",s.data.data[0]),s.data||(a.value="No Data Available!")}catch(s){"401"!=s.response.status&&"429"!=s.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"})),a.value="No Data Available!"}},h=async e=>{try{await o().post(`${t}sent`,e,{headers:{"Content-Type":"multipart/form-data"}}),i["default"].dispatch("updateCurrentPage","Sent"),n.push({name:"Index"})}catch(a){"401"!=a.response.status&&"429"!=a.response.status||(i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"}))}},b=async a=>{try{await o().post(`${t}login`,a);e.value="",i["default"].dispatch("updateLoginStatus",!0),i["default"].dispatch("updateCurrentPage","Inbox"),i["default"].dispatch("updateSkipLimit",{skip:0,limit:10}),i["default"].dispatch("updateCurrentMessage",{}),i["default"].dispatch("updateEditMode","Compose"),i["default"].dispatch("openCloseSidebar",!1),n.push({name:"Index"})}catch(s){e.value=s.response.data.Error}},w=async()=>{try{await o().post(`${t}logout`,{});i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"})}catch(e){i["default"].dispatch("updateLoginStatus",!1),n.push({name:"Login"})}};return{error:a,loginError:e,load:p,download:u,fullEmail:v,addStar:r,removeStar:c,markAsRead:m,block:f,unblock:g,toTrash:d,sendMail:h,login:b,logout:w}},u=p},2297:(e,a,t)=>{t.r(a),t.d(a,{default:()=>_});t(2100);var s=t(3673),n=t(1959),o=t(2323),l=t(9582),i=t(8825),p=t(3617),u=t(3750),d=t.n(u),r=t(482);const c={class:"q-mt-sm sd-center text-bold text-purple",style:{"font-size":"20px"}},m=(0,s.Uk)(" Send "),f=(0,s.Uk)(" Clear "),g={class:"sd-center q-mt-sm q-px-md"},v={class:"sd-center q-px-sm"},h={setup(e){(0,l.tv)();const a=(0,p.oR)(),t=(0,i.Z)(),u=(0,n.iH)(null),{sendMail:h}=(0,r.Z)(),b=!t.platform.is.mobile,w=(0,n.iH)(""),y=(0,n.iH)(""),L=(0,n.iH)(""),x=(0,n.iH)(""),S=(0,n.iH)(""),k=(0,n.iH)(null);function q(e){const a=["image/png","image/jpeg","image/jpg","image/gif","image/webp","image/svg","image/vnd.adobe.photoshop","audio/mpeg","application/mp4","video/webm","application/pdf","application/zip","application/x-7z-compressed","application/tar.gz","application/x-font-ttf","application/x-font-woff","application/msword","application/vnd.ms-powerpoint","application/vnd.apple.pages","application/vnd.apple.keynote","application/vnd.apple.numbers","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.presentationml.slideshow","application/vnd.openxmlformats-officedocument.presentationml.template","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.template","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.wordprocessingml.template"];return e.filter((e=>a.includes(e.type)))}function C(e){let a="";"max-total-size"==e[0].failedPropValidation&&(a=`Total file size should be less than 25 MB: ${e[0].file.name}`),"filter"==e[0].failedPropValidation&&(a=`Filetype not supported: ${e[0].file.name}`),t.notify({type:"negative",message:a})}function V(){y.value=L.value=x.value=S.value=w.value="",k.value=null,a.dispatch("updateEditMode","Compose")}async function D(){const e=new FormData;if(k.value)for(let a in k.value)e.append("file",k.value[a]);e.append("info",JSON.stringify({from:y.value,to:L.value,subject:x.value,message:d().sanitize(S.value)})),await h(e)}function U(e){if("INPUT"===e.target.nodeName)return;let a,t;e.preventDefault(),e.stopPropagation(),e.originalEvent&&e.originalEvent.clipboardData.getData?(a=e.originalEvent.clipboardData.getData("text/plain"),u.value.runCmd("insertText",a)):e.clipboardData&&e.clipboardData.getData?(a=e.clipboardData.getData("text/plain"),u.value.runCmd("insertText",a)):window.clipboardData&&window.clipboardData.getData&&(t||(t=!0,u.value.runCmd("ms-pasteTextOnly",a)),t=!1)}return(0,s.bv)((()=>{"Reply"==a.state.editMode&&(y.value=a.state.currentMessage.to,L.value=a.state.currentMessage.from,x.value=`RE: ${a.state.currentMessage.subject}`,S.value=`\r\n\r\n\r\n\r\n<br/><br/><br/><br/><br/><br/>----------------------------------------------------------------<br/><br/>\r\n\r\n${d().sanitize(a.state.currentMessage.message)}`)})),(e,t)=>{const l=(0,s.up)("q-icon"),i=(0,s.up)("q-item-section"),p=(0,s.up)("q-tooltip"),d=(0,s.up)("q-btn"),r=(0,s.up)("q-item"),h=(0,s.up)("q-separator"),w=(0,s.up)("q-input"),_=(0,s.up)("q-file"),$=(0,s.up)("q-editor");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",c,[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(i,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"Compose"==(0,n.SU)(a).state.editMode?"edit":"reply",size:"md"},null,8,["name"])])),_:1}),(0,s.Wm)(i,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,o.zw)("Compose"==(0,n.SU)(a).state.editMode?"Compose":"Reply"),1)])),_:1}),(0,s.Wm)(i,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{outline:"",round:"",color:"green",icon:"send",size:"md",onClick:D},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{class:"bg-green text-white"},{default:(0,s.w5)((()=>[m])),_:1})])),_:1})])),_:1}),(0,s.Wm)(i,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{outline:"",round:"",color:"black",icon:"clear",size:"md",onClick:V},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[f])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(h,{class:"bg-grey-4 q-mt-md q-mx-md"})]),(0,s._)("div",g,[(0,s.Wm)(w,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),label:"From"},null,8,["modelValue"]),(0,s.Wm)(w,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),label:"To",class:"q-mt-sm"},null,8,["modelValue"]),(0,s.Wm)(w,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]=e=>x.value=e),label:"Subject",class:"q-mt-sm"},null,8,["modelValue"]),(0,s.Wm)(_,{modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=e=>k.value=e),label:"Attach files","use-chips":"",append:"",multiple:"","max-total-size":"25165824",onRejected:C,filter:q,class:(0,o.C_)((0,n.SU)(b)?"q-mt-sm q-mb-lg":"q-mt-sm q-mb-sm")},{prepend:(0,s.w5)((()=>[(0,s.Wm)(l,{name:"attach_file"})])),_:1},8,["modelValue","class"]),(0,n.SU)(b)?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(w,{key:0,borderless:"",modelValue:S.value,"onUpdate:modelValue":t[4]||(t[4]=e=>S.value=e),type:"textarea",rows:"16",label:"Message"},null,8,["modelValue"]))]),(0,s._)("div",v,[(0,n.SU)(b)?((0,s.wg)(),(0,s.j4)($,{key:0,modelValue:S.value,"onUpdate:modelValue":t[5]||(t[5]=e=>S.value=e),ref_key:"editorRef",ref:u,"min-height":"300px","max-height":"300px",flat:"",placeholder:"Message",onPaste:U},null,8,["modelValue"])):(0,s.kq)("",!0)])],64)}}};var b=t(3414),w=t(2035),y=t(4554),L=t(2165),x=t(8870),S=t(5869),k=t(2426),q=t(6239),C=t(1945),V=t(7518),D=t.n(V);const U=h,_=U;D()(h,"components",{QItem:b.Z,QItemSection:w.Z,QIcon:y.Z,QBtn:L.Z,QTooltip:x.Z,QSeparator:S.Z,QInput:k.Z,QFile:q.Z,QEditor:C.Z})}}]);